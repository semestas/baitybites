<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pesan Risol Mayo - Baitybites</title>
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#f59638">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body class="bg-neutral-50">
    <div class="page-wrapper">
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <a href="/" class="logo">
                        <img src="/assets/logo.png" alt="Baitybites Logo" class="h-50">
                    </a>
                    <nav class="nav" id="mainNav"></nav>
                </div>
            </div>
        </header>

        <main class="main-content order-main-content">
            <div class="container order-page-container">
                <!-- Loyalty Benefits Notice -->
                <div id="loyalty-notice" class="info-box mb-4 animate-fade-in hidden">
                    <div class="notice-content">
                        <div class="notice-icon"><i data-lucide="gift"></i></div>
                        <div>
                            <p class="notice-title">Dapatkan Keuntungan Lebih sebagai Pelanggan Setia!</p>
                            <p class="notice-text">Yuk, <strong>login</strong> untuk menikmati berbagai kemudahan
                                dan promo eksklusif:</p>
                            <div class="login-btn-wrapper">
                                <a href="/login.html" class="btn btn-primary btn-sm block-inline">Login / Daftar
                                    Sekarang</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Category Navigation -->
                <div class="category-tabs" id="categoryTabs">
                    <div class="category-tab active" onclick="filterProducts('Risol')">Risol</div>
                    <div class="category-tab" onclick="filterProducts('Kue Kering')">Kue Kering</div>
                    <div class="category-tab" onclick="filterProducts('Kue Oven')">Kue Oven</div>
                </div>

                <!-- Product Grid -->
                <div id="productList" class="product-grid">
                    <div class="spinner product-spinner"></div>
                </div>

                <!-- Order Summary Section (Initial Hidden) -->
                <div id="order-confirmation-section" class="animate-fade-in hidden">
                    <div class="preview-header">
                        <h2 class="text-center w-full mb-8">Ringkasan Pesanan</h2>
                    </div>

                    <div class="order-summary-box">
                        <div class="summary-table">
                            <div class="summary-table-header">
                                <div class="summary-table-header-text">Product</div>
                                <div class="summary-table-header-text">QTY</div>
                                <div class="summary-table-header-text">Total</div>
                            </div>
                            <div id="summary-items">
                                <!-- Filled by JS -->
                            </div>
                        </div>

                        <div class="summary-footer">
                            <div class="footer-row">
                                <span>Total Pesanan</span>
                                <span id="summary-subtotal">Rp 0</span>
                            </div>
                            <div class="footer-row">
                                <span>Kode Promo</span>
                                <span>- Rp 0</span>
                            </div>
                            <div class="footer-row">
                                <span>Ongkir</span>
                                <span>Rp 0</span>
                            </div>
                            <div class="footer-row total-row">
                                <span>Total</span>
                                <span id="summary-total">Rp 0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Info Preview (Hidden by default) -->
                    <div id="customer-info-preview" class="animate-fade-in hidden">
                        <div class="preview-header">
                            <div class="preview-title-wrapper">
                                <h3 class="preview-title">Data Pengiriman</h3>
                                <span class="preview-badge">Sudah Disimpan</span>
                            </div>
                            <button type="button" onclick="showOrderFormEdit()" class="btn btn-outline btn-sm">
                                Ubah
                            </button>
                        </div>

                        <div class="preview-grid">
                            <div class="preview-item">
                                <label>Nama Lengkap</label>
                                <div id="preview-name" class="preview-value">-</div>
                            </div>
                            <div class="preview-item">
                                <label>Nomor WhatsApp</label>
                                <div id="preview-phone" class="preview-value">-</div>
                            </div>
                            <div class="preview-item full-width">
                                <label>Alamat Tujuan</label>
                                <div id="preview-address" class="preview-value address">-</div>
                            </div>
                        </div>
                    </div>

                    <form id="orderForm">
                        <div id="customer-form-fields">
                            <div class="card p-4 mb-4">
                                <div class="grid grid-2">
                                    <div class="form-group">
                                        <label class="form-label">Nama Lengkap</label>
                                        <input type="text" id="name" class="form-input" placeholder="Nama Anda"
                                            required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Nomor WhatsApp</label>
                                        <input type="tel" id="phone" class="form-input" placeholder="08..." required>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Email</label>
                                    <input type="email" id="email" class="form-input" placeholder="email@contoh.com"
                                        required>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Alamat Pengiriman</label>
                                    <textarea id="address" class="form-textarea" placeholder="Alamat lengkap"
                                        required></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Catatan Tambahan (Opsional)</label>
                            <input type="text" id="notes" class="form-input" placeholder="Contoh: Sambal dipisah">
                        </div>

                        <div class="mt-4">
                            <button type="submit" class="btn btn-primary btn-lg w-full">
                                <span id="btnText">Lanjut Proses</span>
                                <div id="btnSpinner" class="spinner btn-spinner wh-20 hidden"></div>
                            </button>
                            <button type="button" onclick="backToProductList()"
                                class="btn btn-outline btn-lg mt-2 w-full">
                                Kembali Pilih Produk
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Sticky Order Summary Bar -->
                <div id="stickySummaryBar" class="order-summary-bar">
                    <div class="summary-content">
                        <div class="summary-details">
                            <div class="summary-item">
                                <span class="label">Total Pesanan</span>
                                <span class="value" id="stickyTotal">Rp 0</span>
                            </div>
                            <div class="summary-item">
                                <span class="label">Item Terpilih</span>
                                <span class="value" id="stickyCount">0 Items</span>
                            </div>
                        </div>
                        <button type="button" class="btn-checkout" onclick="proceedToConfirmation()">
                            Konfirmasi Item
                        </button>
                    </div>
                </div>

                <!-- Recent Orders for Logged-in Users -->
                <div id="recentOrdersSection" class="mt-6 animate-fade-in hidden">
                    <div class="card">
                        <div class="card-header flex justify-between items-center cursor-pointer"
                            onclick="toggleRecentOrders()">
                            <div class="flex items-center gap-2">
                                <i id="recentOrdersChevron" data-lucide="chevron-up" class="transition-transform"></i>
                                <h4 class="card-title no-margin">Pesanan Terbaru Anda</h4>
                            </div>
                            <button onclick="event.stopPropagation(); loadRecentOrders()"
                                class="btn btn-outline btn-sm">Refresh</button>
                        </div>
                        <div id="recentOrdersBody" class="card-body transition-all">
                            <div id="recentOrdersList" class="flex flex-col gap-2">
                                <p class="text-center text-muted">Memuat pesanan...</p>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Redesigned Success Modal -->
                <div id="successModal" class="modal-overlay">
                    <div class="modal animate-scale-up">
                        <div class="modal-header">
                            <div class="icon-wrapper">
                                <i data-lucide="party-popper" size="64"></i>
                            </div>
                            <h2>Pesanan Berhasil!</h2>
                            <p>Terima kasih telah memesan di Baitybites</p>
                            <div class="decorative-curve"></div>
                        </div>

                        <div class="modal-body">
                            <div class="order-info">
                                <p class="text-muted text-sm">
                                    Silakan simpan nomor order Anda untuk melacak proses produksi & pengiriman.
                                </p>

                                <div class="info-box">
                                    <div class="info-row">
                                        <span>Nomor Order</span>
                                        <div id="successOrderNumber" class="info-value order-id">PO-XXXX</div>
                                    </div>
                                    <div class="info-row">
                                        <span>Nomor Invoice</span>
                                        <div id="successInvoiceNumber" class="info-value invoice-id">INV-XXXX</div>
                                    </div>
                                </div>
                            </div>

                            <div class="action-buttons">
                                <button id="btnCopy" class="btn btn-primary btn-copy">
                                    <span>Salin Nomor Order</span>
                                </button>
                                <a id="btnTrackLink" href="#" class="btn btn-primary btn-track">
                                    <span>Lacak Pesanan</span>
                                </a>
                                <button onclick="location.reload()" class="btn btn-outline btn-order-close">
                                    <span>Tutup</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="footer-simple mt-4xl">
            <div class="container">
                <div class="footer-simple-content">
                    <div id="footer-socials" class="footer-socials"></div>
                    <span class="copyright">&copy; 2026 Baitybites. All rights reserved.</span>
                    <a href="/privacy.html" class="footer-link">Kebijakan Privasi</a>
                    <a href="/tos.html" class="footer-link">Ketentuan Layanan</a>
                </div>
            </div>
        </footer>
    </div>

    <script src="/js/app.js"></script>
    <script src="/js/order.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (window.lucide) lucide.createIcons();
        });
    </script>
</body>

</html>